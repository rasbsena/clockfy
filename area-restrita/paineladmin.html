<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clockfy - Painel Admin</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='%23270949' d='M50,5L25,35h50L50,5z'/%3E%3Ccircle fill='%23f93d00' cx='50' cy='60' r='35'/%3E%3Ccircle fill='%23270949' cx='50' cy='60' r='28'/%3E%3Ccircle fill='%23fff' cx='50' cy='60' r='23'/%3E%3C/svg%3E">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --roxo-escuro: #270949;
      --roxo-medio: #87148C;
      --roxo-vivo: #4F1295;
      --laranja: #F93D00;
      --laranja-esc: #e03800;
      --branco: #fff;
      --vidro: rgba(39, 9, 73, 0.6);
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, #270949 0%, #1a0430 100%);
      min-height: 100vh;
      padding: 20px;
      color: #fff;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* HEADER */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding: 20px;
      background: var(--vidro);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      border: 1px solid rgba(249, 61, 0, 0.1);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo {
      width: 50px;
      height: 50px;
    }

    .header-title {
      font-size: 28px;
      font-weight: 800;
    }

    .header-title span {
      color: var(--laranja);
    }

    .admin-badge {
      background: var(--laranja);
      color: #fff;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .btn {
      border: none;
      border-radius: 12px;
      padding: 12px 24px;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Montserrat', sans-serif;
    }

    .btn-primary {
      background: var(--laranja);
      color: #fff;
    }

    .btn-primary:hover {
      background: var(--laranja-esc);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(249, 61, 0, 0.4);
    }

    .btn-ghost {
      background: transparent;
      color: #fff;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .btn-ghost:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.4);
    }

    /* MAIN GRID */
    .main-grid {
      display: grid;
      grid-template-columns: 400px 1fr;
      gap: 20px;
    }

    .card {
      background: var(--vidro);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 24px;
      border: 1px solid rgba(249, 61, 0, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    .card-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .card-subtitle {
      color: #a8a8a8;
      font-size: 14px;
      margin-bottom: 20px;
    }

    /* BUSCA */
    .search-section {
      margin-bottom: 20px;
    }

    .search-label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #e0e0e0;
    }

    .search-input {
      width: 100%;
      padding: 14px 16px;
      border-radius: 12px;
      border: 2px solid rgba(255, 255, 255, 0.15);
      background: rgba(20, 5, 35, 0.8);
      color: #fff;
      font-family: 'Montserrat', sans-serif;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--laranja);
      background: rgba(20, 5, 35, 0.95);
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.4);
    }

    /* SUGEST√ïES */
    .suggestions {
      margin-top: 10px;
      max-height: 300px;
      overflow-y: auto;
      display: none;
    }

    .suggestions.show {
      display: block;
    }

    .suggestion-item {
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .suggestion-item:hover {
      background: rgba(249, 61, 0, 0.1);
      border-color: rgba(249, 61, 0, 0.3);
      transform: translateX(5px);
    }

    .suggestion-name {
      font-weight: 600;
      color: #fff;
      margin-bottom: 4px;
    }

    .suggestion-info {
      font-size: 12px;
      color: #a8a8a8;
    }

    .no-results {
      padding: 20px;
      text-align: center;
      color: #a8a8a8;
      font-size: 14px;
    }

    /* FUNCION√ÅRIO SELECIONADO */
    .selected-employee {
      display: none;
      padding: 20px;
      background: rgba(249, 61, 0, 0.1);
      border: 2px solid rgba(249, 61, 0, 0.3);
      border-radius: 16px;
      margin-top: 20px;
    }

    .selected-employee.show {
      display: block;
    }

    .selected-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 16px;
    }

    .selected-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--laranja);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .selected-name {
      font-size: 20px;
      font-weight: 800;
      color: #fff;
      margin-bottom: 4px;
    }

    .selected-id {
      font-size: 13px;
      color: #a8a8a8;
    }

    .btn-clear {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-clear:hover {
      background: rgba(239, 68, 68, 0.2);
      border-color: rgba(239, 68, 68, 0.5);
    }

    .selected-details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      padding-top: 16px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .detail-item {
      font-size: 13px;
    }

    .detail-label {
      color: #a8a8a8;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .detail-value {
      color: #fff;
      font-weight: 500;
    }

    /* MENU DE A√á√ïES */
    .actions-menu {
      display: none;
    }

    .actions-menu.show {
      display: block;
    }

    .action-btn {
      width: 100%;
      padding: 16px 20px;
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      color: #fff;
      font-weight: 600;
      font-size: 14px;
      text-align: left;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 12px;
      font-family: 'Montserrat', sans-serif;
    }

    .action-btn:hover {
      background: rgba(249, 61, 0, 0.1);
      border-color: rgba(249, 61, 0, 0.3);
      transform: translateX(5px);
    }

    .action-icon {
      font-size: 20px;
    }

    /* √ÅREA DE FORMUL√ÅRIOS */
    .form-area {
      display: none;
    }

    .form-area.show {
      display: block;
    }

    .form-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 2px solid rgba(249, 61, 0, 0.2);
    }

    .form-title {
      font-size: 22px;
      font-weight: 700;
      color: #fff;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #e0e0e0;
    }

    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: 2px solid rgba(255, 255, 255, 0.15);
      background: rgba(20, 5, 35, 0.8);
      color: #fff;
      font-family: 'Montserrat', sans-serif;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .form-textarea {
      min-height: 100px;
      resize: vertical;
    }

    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--laranja);
      background: rgba(20, 5, 35, 0.95);
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    .form-actions {
      display: flex;
      gap: 12px;
      margin-top: 24px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .message {
      padding: 12px 16px;
      border-radius: 10px;
      font-size: 14px;
      margin-top: 16px;
      display: none;
      animation: slideIn 0.3s ease;
    }

    .message.show {
      display: block;
    }

    .message.success {
      background: rgba(34, 197, 94, 0.15);
      border: 1px solid rgba(34, 197, 94, 0.4);
      color: #86efac;
    }

    .message.error {
      background: rgba(239, 68, 68, 0.15);
      border: 1px solid rgba(239, 68, 68, 0.4);
      color: #fca5a5;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #a8a8a8;
    }

    .empty-state-icon {
      font-size: 64px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-state-text {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .empty-state-subtext {
      font-size: 14px;
    }

    @media (max-width: 1200px) {
      .main-grid {
        grid-template-columns: 1fr;
      }

      .form-row {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Prote√ß√£o de acesso Admin -->
  <script>
    const role = localStorage.getItem('role');
    const usuarioJson = localStorage.getItem('usuario');
    let isAdmin = false;

    if (role === 'Admin') {
      isAdmin = true;
    } else if (usuarioJson) {
      try {
        const usuario = JSON.parse(usuarioJson);
        if (usuario.nivel_acesso === 'Admin' || usuario.role === 'Admin') {
          isAdmin = true;
        }
      } catch (e) {}
    }

    if (!isAdmin) {
      alert('Acesso negado! Apenas administradores podem acessar esta √°rea.');
      window.location.href = 'painel.html';
    }
  </script>

  <div class="container">
    <!-- HEADER -->
    <header class="header">
      <div class="header-left">
        <svg class="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <path fill="#270949" d="M50,5L25,35h50L50,5z"/>
          <circle fill="#f93d00" cx="50" cy="60" r="35"/>
          <circle fill="#270949" cx="50" cy="60" r="28"/>
          <circle fill="#fff" cx="50" cy="60" r="23"/>
        </svg>
        <div>
          <div class="header-title">Clock<span>fy</span></div>
          <div class="admin-badge">‚öôÔ∏è Admin</div>
        </div>
      </div>
      <div>
        <button class="btn btn-ghost" onclick="window.location.href='painel.html'" style="margin-right: 10px;">
          ‚Üê Voltar ao Painel
        </button>
        <button class="btn btn-primary" onclick="logout()">Sair</button>
      </div>
    </header>

    <!-- MAIN GRID -->
    <div class="main-grid">
      <!-- COLUNA ESQUERDA: BUSCA E SELE√á√ÉO -->
      <aside>
        <div class="card">
          <h2 class="card-title">üîç Buscar Funcion√°rio</h2>
          <p class="card-subtitle">Digite nome ou ID para localizar</p>

          <!-- Busca por Nome -->
          <div class="search-section">
            <label class="search-label">Buscar por Nome</label>
            <input 
              type="text" 
              class="search-input" 
              id="searchName" 
              placeholder="Digite pelo menos 3 caracteres..."
            >
            <div class="suggestions" id="suggestionsName"></div>
          </div>

          <!-- Busca por ID -->
          <div class="search-section">
            <label class="search-label">Buscar por ID</label>
            <input 
              type="text" 
              class="search-input" 
              id="searchId" 
              placeholder="Digite o ID do funcion√°rio..."
            >
            <div class="suggestions" id="suggestionsId"></div>
          </div>

          <!-- Funcion√°rio Selecionado -->
          <div class="selected-employee" id="selectedEmployee">
            <div class="selected-header">
              <div>
                <div class="selected-title">‚úì Funcion√°rio Selecionado</div>
                <div class="selected-name" id="selectedName">-</div>
                <div class="selected-id">ID: <span id="selectedId">-</span></div>
              </div>
              <button class="btn-clear" onclick="clearSelection()">‚úï Limpar</button>
            </div>
            <div class="selected-details">
              <div class="detail-item">
                <div class="detail-label">E-mail</div>
                <div class="detail-value" id="selectedEmail">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">WhatsApp</div>
                <div class="detail-value" id="selectedWhatsApp">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Cargo</div>
                <div class="detail-value" id="selectedRole">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Carga Hor√°ria</div>
                <div class="detail-value" id="selectedCarga">-</div>
              </div>
            </div>
          </div>
        </div>

        <!-- MENU DE A√á√ïES -->
        <div class="card actions-menu" id="actionsMenu" style="margin-top: 20px;">
          <h3 class="card-title">‚ö° A√ß√µes Dispon√≠veis</h3>
          <p class="card-subtitle">Escolha uma a√ß√£o para executar</p>

          <button class="action-btn" onclick="openForm('corrigir')">
            <span class="action-icon">‚úèÔ∏è</span>
            <span>Corrigir Ponto</span>
          </button>

          <button class="action-btn" onclick="openForm('lancar')">
            <span class="action-icon">üìù</span>
            <span>Lan√ßar Ponto Antigo</span>
          </button>

          <button class="action-btn" onclick="openForm('espelho')">
            <span class="action-icon">üìÑ</span>
            <span>Receber Espelho de Ponto</span>
          </button>

          <button class="action-btn" onclick="openForm('atualizar')">
            <span class="action-icon">üë§</span>
            <span>Atualizar Dados</span>
          </button>

          <button class="action-btn" onclick="openForm('promover')">
            <span class="action-icon">‚≠ê</span>
            <span>Promover para Admin</span>
          </button>

          <button class="action-btn" onclick="openForm('excluir')">
            <span class="action-icon">üóëÔ∏è</span>
            <span>Excluir Funcion√°rio</span>
          </button>
        </div>
      </aside>

      <!-- COLUNA DIREITA: FORMUL√ÅRIOS -->
      <main>
        <!-- EMPTY STATE -->
        <div class="card empty-state" id="emptyState">
          <div class="empty-state-icon">üëà</div>
          <div class="empty-state-text">Selecione um funcion√°rio</div>
          <div class="empty-state-subtext">Use a busca ao lado para localizar e selecionar um funcion√°rio</div>
        </div>

        <!-- FORMUL√ÅRIO: CORRIGIR PONTO -->
        <div class="card form-area" id="formCorrigir">
          <div class="form-header">
            <h2 class="form-title">‚úèÔ∏è Corrigir Ponto</h2>
            <button class="btn-ghost" onclick="closeForm()">‚úï Fechar</button>
          </div>
          <form id="formCorrigirSubmit">
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Data</label>
                <input type="date" class="form-input" required>
              </div>
              <div class="form-group">
                <label class="form-label">Tipo de Registro</label>
                <select class="form-select" required>
                  <option value="">Selecione</option>
                  <option value="entrada">Entrada</option>
                  <option value="saida_almoco">Sa√≠da para Almo√ßo</option>
                  <option value="retorno_almoco">Retorno do Almo√ßo</option>
                  <option value="saida">Sa√≠da</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Hor√°rio Correto</label>
              <input type="time" class="form-input" required>
            </div>
            <div class="form-group">
              <label class="form-label">Motivo da Corre√ß√£o</label>
              <textarea class="form-textarea" placeholder="Descreva o motivo..." required></textarea>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary" style="flex: 1;">Salvar Corre√ß√£o</button>
              <button type="button" class="btn btn-ghost" onclick="closeForm()">Cancelar</button>
            </div>
            <div class="message" id="messageCorrigir"></div>
          </form>
        </div>

        <!-- FORMUL√ÅRIO: LAN√áAR PONTO ANTIGO -->
        <div class="card form-area" id="formLancar">
          <div class="form-header">
            <h2 class="form-title">üìù Lan√ßar Ponto Antigo</h2>
            <button class="btn-ghost" onclick="closeForm()">‚úï Fechar</button>
          </div>
          <form id="formLancarSubmit">
            <div class="form-group">
              <label class="form-label">Data do Ponto</label>
              <input type="date" class="form-input" required>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Entrada</label>
                <input type="time" class="form-input" required>
              </div>
              <div class="form-group">
                <label class="form-label">Sa√≠da para Almo√ßo</label>
                <input type="time" class="form-input">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Retorno do Almo√ßo</label>
                <input type="time" class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label">Sa√≠da</label>
                <input type="time" class="form-input" required>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Observa√ß√µes</label>
              <textarea class="form-textarea" placeholder="Informa√ß√µes adicionais..."></textarea>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary" style="flex: 1;">Lan√ßar Ponto</button>
              <button type="button" class="btn btn-ghost" onclick="closeForm()">Cancelar</button>
            </div>
            <div class="message" id="messageLancar"></div>
          </form>
        </div>

        <!-- FORMUL√ÅRIO: RECEBER ESPELHO -->
        <div class="card form-area" id="formEspelho">
          <div class="form-header">
            <h2 class="form-title">üìÑ Receber Espelho de Ponto</h2>
            <button class="btn-ghost" onclick="closeForm()">‚úï Fechar</button>
          </div>
          <form id="formEspelhoSubmit">
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">M√™s</label>
                <select class="form-select" required>
                  <option value="">Selecione</option>
                  <option value="01">Janeiro</option>
                  <option value="02">Fevereiro</option>
                  <option value="03">Mar√ßo</option>
                  <option value="04">Abril</option>
                  <option value="05">Maio</option>
                  <option value="06">Junho</option>
                  <option value="07">Julho</option>
                  <option value="08">Agosto</option>
                  <option value="09">Setembro</option>
                  <option value="10">Outubro</option>
                  <option value="11">Novembro</option>
                  <option value="12">Dezembro</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Ano</label>
                <input type="number" class="form-input" min="2023" max="2030" value="2025" required>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">E-mail para Envio</label>
              <input type="email" class="form-input" placeholder="email@exemplo.com" required>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary" style="flex: 1;">Enviar Espelho</button>
              <button type="button" class="btn btn-ghost" onclick="closeForm()">Cancelar</button>
            </div>
            <div class="message" id="messageEspelho"></div>
          </form>
        </div>

        <!-- FORMUL√ÅRIO: ATUALIZAR DADOS -->
        <div class="card form-area" id="formAtualizar">
          <div class="form-header">
            <h2 class="form-title">üë§ Atualizar Dados do Funcion√°rio</h2>
            <button class="btn-ghost" onclick="closeForm()">‚úï Fechar</button>
          </div>
          <form id="formAtualizarSubmit">
            <div class="form-group">
              <label class="form-label">Nome Completo</label>
              <input type="text" class="form-input" id="updateNome" required>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">E-mail</label>
                <input type="email" class="form-input" id="updateEmail" required>
              </div>
              <div class="form-group">
                <label class="form-label">WhatsApp</label>
                <input type="tel" class="form-input" id="updateWhatsApp" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Carga Hor√°ria Di√°ria (horas)</label>
                <input type="number" class="form-input" id="updateCarga" min="0" step="0.5" required>
              </div>
              <div class="form-group">
                <label class="form-label">PIN de Acesso</label>
                <input type="text" class="form-input" id="updatePin" maxlength="4" required>
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary" style="flex: 1;">Salvar Altera√ß√µes</button>
              <button type="button" class="btn btn-ghost" onclick="closeForm()">Cancelar</button>
            </div>
            <div class="message" id="messageAtualizar"></div>
          </form>
        </div>

        <!-- FORMUL√ÅRIO: PROMOVER PARA ADMIN -->
        <div class="card form-area" id="formPromover">
          <div class="form-header">
            <h2 class="form-title">‚≠ê Promover para Administrador</h2>
            <button class="btn-ghost" onclick="closeForm()">‚úï Fechar</button>
          </div>
          <form id="formPromoverSubmit">
            <div style="padding: 20px; background: rgba(249, 61, 0, 0.1); border: 1px solid rgba(249, 61, 0, 0.3); border-radius: 12px; margin-bottom: 20px;">
              <p style="margin-bottom: 12px; font-weight: 600; color: var(--laranja);">‚ö†Ô∏è Aten√ß√£o!</p>
              <p style="font-size: 14px; line-height: 1.6; color: #e0e0e0;">
                Voc√™ est√° prestes a promover <strong id="promoverNome">este funcion√°rio</strong> para Administrador. 
                Esta a√ß√£o conceder√° acesso total ao sistema, incluindo este painel administrativo.
              </p>
            </div>
            <div class="form-group">
              <label class="form-label">Confirme digitando "PROMOVER"</label>
              <input type="text" class="form-input" id="confirmPromover" placeholder="Digite PROMOVER para confirmar" required>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary" style="flex: 1;">Confirmar Promo√ß√£o</button>
              <button type="button" class="btn btn-ghost" onclick="closeForm()">Cancelar</button>
            </div>
            <div class="message" id="messagePromover"></div>
          </form>
        </div>

        <!-- FORMUL√ÅRIO: EXCLUIR FUNCION√ÅRIO -->
        <div class="card form-area" id="formExcluir">
          <div class="form-header">
            <h2 class="form-title">üóëÔ∏è Excluir Funcion√°rio</h2>
            <button class="btn-ghost" onclick="closeForm()">‚úï Fechar</button>
          </div>
          <form id="formExcluirSubmit">
            <div style="padding: 20px; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 12px; margin-bottom: 20px;">
              <p style="margin-bottom: 12px; font-weight: 600; color: #f87171;">üö® A√ß√£o Irrevers√≠vel!</p>
              <p style="font-size: 14px; line-height: 1.6; color: #e0e0e0;">
                Voc√™ est√° prestes a excluir permanentemente <strong id="excluirNome">este funcion√°rio</strong> e todos os seus registros de ponto. 
                Esta a√ß√£o <strong>N√ÉO PODE</strong> ser desfeita.
              </p>
            </div>
            <div class="form-group">
              <label class="form-label">Motivo da Exclus√£o</label>
              <textarea class="form-textarea" placeholder="Descreva o motivo..." required></textarea>
            </div>
            <div class="form-group">
              <label class="form-label">Confirme digitando "EXCLUIR PERMANENTEMENTE"</label>
              <input type="text" class="form-input" id="confirmExcluir" placeholder="Digite EXCLUIR PERMANENTEMENTE" required>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary" style="flex: 1; background: #ef4444;">Excluir Permanentemente</button>
              <button type="button" class="btn btn-ghost" onclick="closeForm()">Cancelar</button>
            </div>
            <div class="message" id="messageExcluir"></div>
          </form>
        </div>
      </main>
    </div>
  </div>

  <script>
    // ========== CONFIGURA√á√ÉO ==========
    const WEBHOOK_SEARCH = 'https://n8n.upperfy.com.br/webhook/b9750986-24a2-46f5-820f-clockadminsearch';
    
    // ========== VARI√ÅVEIS GLOBAIS ==========
    let selectedEmployee = null;
    let searchTimeout = null;

    // ========== ELEMENTOS DO DOM ==========
    const searchName = document.getElementById('searchName');
    const searchId = document.getElementById('searchId');
    const suggestionsName = document.getElementById('suggestionsName');
    const suggestionsId = document.getElementById('suggestionsId');
    const selectedEmployeeDiv = document.getElementById('selectedEmployee');
    const actionsMenu = document.getElementById('actionsMenu');
    const emptyState = document.getElementById('emptyState');

    // ========== FUN√á√ïES DE BUSCA ==========
    searchName.addEventListener('input', (e) => {
      const query = e.target.value.trim();
      
      if (query.length >= 3) {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
          searchEmployees('nome', query, suggestionsName);
        }, 300);
      } else {
        suggestionsName.classList.remove('show');
        suggestionsName.innerHTML = '';
      }
    });

    searchId.addEventListener('input', (e) => {
      const query = e.target.value.trim();
      
      console.log('üî§ Input ID changed:', query);
      
      if (query.length >= 1) {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
          console.log('‚è∞ Timeout executado, iniciando busca...');
          searchEmployees('id', query, suggestionsId);
        }, 300);
      } else {
        suggestionsId.classList.remove('show');
        suggestionsId.innerHTML = '';
      }
    });

    async function searchEmployees(type, query, suggestionsElement) {
      console.log('üîç === IN√çCIO DA BUSCA ===');
      console.log(`üîç Tipo: ${type}, Query: ${query}`);
      
      suggestionsElement.innerHTML = '<div class="no-results">üîç Buscando...</div>';
      suggestionsElement.classList.add('show');
      console.log('‚úÖ Suggestions element mostrado');

      try {
        const localStorageData = {};
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          localStorageData[key] = localStorage.getItem(key);
        }

        const payload = {
          ...localStorageData,
          tipo_busca: type,
          busca: query
        };

        console.log('üì§ Payload preparado:', payload);
        console.log('üì§ URL do webhook:', WEBHOOK_SEARCH);
        console.log('üì§ Iniciando fetch...');

        const response = await fetch(WEBHOOK_SEARCH, {
          method: 'POST',
          mode: 'cors',
          headers: { 
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify(payload)
        });

        console.log('üì• === RESPOSTA RECEBIDA ===');
        console.log('üì• Response object:', response);
        console.log('üì• Status:', response.status);
        console.log('üì• OK:', response.ok);
        console.log('üì• StatusText:', response.statusText);

        if (!response.ok) {
          console.error('‚ùå Response n√£o OK!');
          throw new Error(`Erro HTTP: ${response.status}`);
        }

        console.log('üì• Lendo body da resposta...');
        const textResponse = await response.text();
        console.log('üì• Resposta em texto RAW:', textResponse);
        console.log('üì• Tamanho da resposta:', textResponse.length);

        let data;
        try {
          console.log('üîÑ Tentando parsear JSON...');
          data = JSON.parse(textResponse);
          console.log('‚úÖ JSON parseado com sucesso!');
        } catch (e) {
          console.error('‚ùå ERRO ao parsear JSON:', e);
          console.error('‚ùå Texto que falhou:', textResponse.substring(0, 200));
          throw new Error('Resposta n√£o √© um JSON v√°lido');
        }

        console.log('‚úÖ === DADOS RECEBIDOS ===');
        console.log('‚úÖ Data:', data);
        console.log('‚úÖ Tipo:', typeof data);
        console.log('‚úÖ √â Array?', Array.isArray(data));
        console.log('‚úÖ Length:', data?.length);

        if (Array.isArray(data)) {
          console.log('‚úÖ Conte√∫do do array:', JSON.stringify(data, null, 2));
        }

        console.log('üé® Chamando displaySuggestions...');
        displaySuggestions(data, suggestionsElement);
        console.log('‚úÖ displaySuggestions executado');

      } catch (error) {
        console.error('‚ùå === ERRO NA BUSCA ===');
        console.error('‚ùå Error object:', error);
        console.error('‚ùå Message:', error.message);
        console.error('‚ùå Stack:', error.stack);
        suggestionsElement.innerHTML = `<div class="no-results">‚ùå Erro: ${error.message}<br>Veja o console (F12)</div>`;
      }
      
      console.log('üîç === FIM DA BUSCA ===');
    }

    function displaySuggestions(employees, suggestionsElement) {
      console.log('üé® Exibindo sugest√µes:', employees);
      
      if (!employees || !Array.isArray(employees) || employees.length === 0) {
        console.log('‚ö†Ô∏è Nenhum resultado para exibir');
        suggestionsElement.innerHTML = '<div class="no-results">üòï Nenhum funcion√°rio encontrado</div>';
        return;
      }

      console.log(`‚úÖ Exibindo ${employees.length} funcion√°rio(s)`);

      const html = employees.map((emp, index) => {
        console.log(`Funcion√°rio ${index}:`, emp);
        
        const empJson = JSON.stringify(emp).replace(/'/g, "\\'");
        
        return `
          <div class="suggestion-item" onclick='selectEmployee(${empJson})'>
            <div class="suggestion-name">${emp.nome_completo || emp.nome || 'Sem nome'}</div>
            <div class="suggestion-info">
              ID: ${emp.id || emp.id_funcionario || 'N/A'} ‚Ä¢ 
              ${emp.email || 'Sem email'} ‚Ä¢ 
              ${emp.role || emp.nivel_acesso || 'Funcion√°rio'}
            </div>
          </div>
        `;
      }).join('');

      console.log('üìù HTML gerado:', html);
      suggestionsElement.innerHTML = html;
    }

    function selectEmployee(employee) {
      console.log('Funcion√°rio selecionado:', employee);
      
      selectedEmployee = employee;
      
      // Atualiza display do funcion√°rio selecionado
      document.getElementById('selectedName').textContent = employee.nome_completo || employee.nome;
      document.getElementById('selectedId').textContent = employee.id || employee.id_funcionario;
      document.getElementById('selectedEmail').textContent = employee.email || '-';
      document.getElementById('selectedWhatsApp').textContent = employee.numero_whatsapp || employee.whatsapp || '-';
      document.getElementById('selectedRole').textContent = employee.role || employee.nivel_acesso || 'Funcion√°rio';
      document.getElementById('selectedCarga').textContent = (employee.carga_horaria_diaria || employee.carga_horaria || '0') + 'h';
      
      // Mostra elementos
      selectedEmployeeDiv.classList.add('show');
      actionsMenu.classList.add('show');
      emptyState.style.display = 'none';
      
      // Limpa sugest√µes
      suggestionsName.classList.remove('show');
      suggestionsId.classList.remove('show');
      suggestionsName.innerHTML = '';
      suggestionsId.innerHTML = '';
      
      // Limpa campos de busca
      searchName.value = '';
      searchId.value = '';
    }

    function clearSelection() {
      selectedEmployee = null;
      selectedEmployeeDiv.classList.remove('show');
      actionsMenu.classList.remove('show');
      emptyState.style.display = 'block';
      closeForm();
    }

    // ========== FUN√á√ïES DE FORMUL√ÅRIO ==========
    function openForm(formType) {
      if (!selectedEmployee) {
        alert('Selecione um funcion√°rio primeiro!');
        return;
      }

      // Esconde todos os formul√°rios
      document.querySelectorAll('.form-area').forEach(form => {
        form.classList.remove('show');
      });

      // Mostra o formul√°rio selecionado
      const formId = `form${formType.charAt(0).toUpperCase() + formType.slice(1)}`;
      const form = document.getElementById(formId);
      
      if (form) {
        form.classList.add('show');
        emptyState.style.display = 'none';
        
        // Preenche campos espec√≠ficos
        if (formType === 'atualizar') {
          document.getElementById('updateNome').value = selectedEmployee.nome_completo || selectedEmployee.nome || '';
          document.getElementById('updateEmail').value = selectedEmployee.email || '';
          document.getElementById('updateWhatsApp').value = selectedEmployee.numero_whatsapp || selectedEmployee.whatsapp || '';
          document.getElementById('updateCarga').value = selectedEmployee.carga_horaria_diaria || selectedEmployee.carga_horaria || 0;
          document.getElementById('updatePin').value = selectedEmployee.pin || '';
        }
        
        if (formType === 'promover') {
          document.getElementById('promoverNome').textContent = selectedEmployee.nome_completo || selectedEmployee.nome;
        }
        
        if (formType === 'excluir') {
          document.getElementById('excluirNome').textContent = selectedEmployee.nome_completo || selectedEmployee.nome;
        }
      }
    }

    function closeForm() {
      document.querySelectorAll('.form-area').forEach(form => {
        form.classList.remove('show');
      });
      
      if (!selectedEmployee) {
        emptyState.style.display = 'block';
      }
    }

    // ========== SUBMISS√ÉO DE FORMUL√ÅRIOS ==========
    
    // Formul√°rio: Corrigir Ponto
    document.getElementById('formCorrigirSubmit').addEventListener('submit', async (e) => {
      e.preventDefault();
      showMessage('messageCorrigir', 'Funcionalidade em desenvolvimento. Em breve!', 'success');
      // TODO: Implementar integra√ß√£o com n8n
    });

    // Formul√°rio: Lan√ßar Ponto
    document.getElementById('formLancarSubmit').addEventListener('submit', async (e) => {
      e.preventDefault();
      showMessage('messageLancar', 'Funcionalidade em desenvolvimento. Em breve!', 'success');
      // TODO: Implementar integra√ß√£o com n8n
    });

    // Formul√°rio: Espelho
    document.getElementById('formEspelhoSubmit').addEventListener('submit', async (e) => {
      e.preventDefault();
      showMessage('messageEspelho', 'Funcionalidade em desenvolvimento. Em breve!', 'success');
      // TODO: Implementar integra√ß√£o com n8n
    });

    // Formul√°rio: Atualizar Dados
    document.getElementById('formAtualizarSubmit').addEventListener('submit', async (e) => {
      e.preventDefault();
      showMessage('messageAtualizar', 'Funcionalidade em desenvolvimento. Em breve!', 'success');
      // TODO: Implementar integra√ß√£o com n8n
    });

    // Formul√°rio: Promover
    document.getElementById('formPromoverSubmit').addEventListener('submit', async (e) => {
      e.preventDefault();
      const confirmText = document.getElementById('confirmPromover').value;
      
      if (confirmText !== 'PROMOVER') {
        showMessage('messagePromover', 'Digite PROMOVER para confirmar a a√ß√£o.', 'error');
        return;
      }
      
      showMessage('messagePromover', 'Funcionalidade em desenvolvimento. Em breve!', 'success');
      // TODO: Implementar integra√ß√£o com n8n
    });

    // Formul√°rio: Excluir
    document.getElementById('formExcluirSubmit').addEventListener('submit', async (e) => {
      e.preventDefault();
      const confirmText = document.getElementById('confirmExcluir').value;
      
      if (confirmText !== 'EXCLUIR PERMANENTEMENTE') {
        showMessage('messageExcluir', 'Digite EXCLUIR PERMANENTEMENTE para confirmar.', 'error');
        return;
      }
      
      showMessage('messageExcluir', 'Funcionalidade em desenvolvimento. Em breve!', 'success');
      // TODO: Implementar integra√ß√£o com n8n
    });

    // ========== FUN√á√ïES AUXILIARES ==========
    function showMessage(elementId, text, type) {
      const messageElement = document.getElementById(elementId);
      messageElement.textContent = text;
      messageElement.className = `message ${type} show`;
      
      setTimeout(() => {
        messageElement.classList.remove('show');
      }, 5000);
    }

    function logout() {
      if (confirm('Deseja realmente sair?')) {
        localStorage.clear();
        window.location.href = '../index.html';
      }
    }

    // ========== INICIALIZA√á√ÉO ==========
    console.log('Painel Admin carregado');
    console.log('Funcion√°rio selecionado:', selectedEmployee);
  </script>
</body>
</html>
